---
layout: article
title: 计算机网络-路由
tags: 计算机网络
category: blog
date: 2022-03-10 00:00:00 +08:00
mermaid: true
---

## 路由的概念

**路由（Routing）**：通过互联网把信息从源地址传输到目的地址转发数据包的过程。路由发生在OSI模型（七层模型）中的第三层即网络层。路由引导分组转送，经过一些中间的节点后，到它们最后的目的地。作成硬件的话，则称为路由器。

**路由器（Router）**：能够将数据包转发到正确目的地，并在转发过程中选择最佳路径的设备。	

**路由表（Routing Table)**：路由器或者联网计算机中的一个储存到各个目的地的最佳路径的表。


> 路由器和交换机的四个区别
> -  路由器是OSI第三层网络层的产品，而交换机则是第二层数据链路层，第二层主要功能是**组建局域网**，将网络上各个电脑的MAC地址记在MAC地址表中，当局域网中的电脑要经过交换机去交换传递资料时，就查询交换机上的MAC地址表中的信息，并将数据包发送给指定的电脑，而不会像第一层的产品（如集线器）发送给每台在网络中的电脑。
> - 路由器能在多条路径中选择最佳的路径，提升交换数据的传输速率。在发送数据包时，路由表会被一同发送，该表存储了前往某一网络的最佳路径。
> - 路由器可连接超过两个以上不同的网络，而交换机只能连接两个
> - 路由器具有IP分享器功能，主要是让多台设备用同一条ADSL/光纤宽带线路来上网，功能包括共享IP，宽带管理，自动分配IP等等，如在共享IP功能中，不同设备可共享同一个公共IP同时上网；在局域网中，路由器则会指定一组的Class C的私有IP，可让254台设备同时上网。

**主要厂商**
 思科 (Cisco) ，华三 (H3C)  ，华为 (Huawei) ，普联 (TP-LINK) ，腾达 (Tenda)， 小米 (Xiaomi)，锐捷 (ruijie)，水星 (Mercury)
 

## 路由的原理
路由器查看了数据包的目的协议地址后，确定是否知道如何转发该包，如果路由器不知道如何转发，通常就将之丢弃。如果路由器知道如何转发，就把目的物理地址变成下一跳的物理地址并向之发送。下一跳可能就是最终的目的主机，如果不是，通常为另一个路由器，它将执行同样的步骤。

## 路由的类型

 - **直连路由**：接口所连接的子网的路由方式，接口配置，无需手工配置，
 - **静态路由**：管理员手动配置，单向，缺乏灵活性，其中**默认路由**是一种特殊的静态路由，当路由器在路由表中找不到目标网络的路由条目时， 路由器把请求转发到默认路口，默认路由只能存在末节网络中。
 - **动态路由**：通过路由协议从相邻路由器动态学习到的路由条目

## 路由的优先级
  直连路由----->静态路由----->动态路由----->默认路由 (优先级由高到低)
  

## 路由的过程
将对方ip地址和自己的子网掩码进行与运算，得到网段号，然后马上查看路由表，查看路由表是否到达。

## 路由协议

https://zh.wikipedia.org/zh-cn/%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE

路由协议（英语：Routing protocol）是一种指定数据包转送方式的网络协议。Internet网络的主要节点设备是路由器，路由器通过路由表来转发接收到的数据。转发策略可以是人工指定的（通过静态路由、策略路由等方法）。在具有较小规模的网络中，人工指定转发策略没有任何问题。但是在具有较大规模的网络中（如跨国企业网络、ISP网络），如果通过人工指定转发策略，将会给网络管理员带来巨大的工作量，并且在管理、维护路由表上也变得十分困难。为了解决这个问题，动态路由协议应运而生。动态路由协议可以让路由器自动学习到其他路由器的网络，并且网络拓扑发生改变后自动更新路由表。网络管理员只需要配置动态路由协议即可，相比人工指定转发策略，工作量大大减少。

常见的路由协议有RIP、IGRP（Cisco私有协议）、EIGRP（Cisco私有协议）、OSPF、IS-IS、BGP等。

RIP、IGRP、EIGRP、OSPF、IS-IS是内部网关协议（IGP），适用于单个ISP的统一路由协议的运行，一般由一个ISP运营的网络位于一个AS（自治系统）内，有统一的AS number（自治系统号）。BGP是自治系统间的路由协议，是一种外部网关协议，多用于不同ISP之间交换路由信息，以及大型企业、政府等具有较大规模的私有网络。

- RIP：RIP很早就被用在Internet上，是最简单的路由协议。它是“路由信息协议（Route Information Protocol）”的简写，主要传递路由信息，通过每隔30秒广播一次路由表，维护相邻路由器的位置关系，同时根据收到的路由表信息计算自己的路由表信息。RIP是一个距离矢量路由协议，最大跳数为15跳，超过15跳的网络则认为目标网络不可达。此协议通常用在网络架构较为简单的小型网络环境。现在分为RIPv1和RIPv2两个版本，后者支持VLSM技术以及一系列技术上的改进。RIP的收敛速度较慢。
- BGP：为了维护各个ISP的独立利益，标准化组织制定了ISP间的路由协议BGP。BGP是“边界网关协议（Border Gateway Protocol）”的缩写，处理各ISP之间的路由传递。但是BGP运行在相对核心的地位，需要用户对网络的结构有相当的了解，否则可能会造成较大损失
- OSPF：OSPF协议是“开放式最短路径优先（Open Shortest Path First）”的缩写，属于链路状态路由协议。OSPF提出了“区域（area）”的概念，每个区域中所有路由器维护着一个相同的链路状态数据库（LSDB）。区域又分为骨干区域（骨干区域的编号必须为0）和非骨干区域（非0编号区域），如果一个运行OSPF的网络只存在单一区域，则该区域可以是骨干区域或者非骨干区域。如果该网络存在多个区域，那么必须存在骨干区域，并且所有非骨干区域必须和骨干区域直接相连。OSPF利用所维护的链路状态数据库，通过最短路径优先算法（SPF算法）计算得到路由表。OSPF的收敛速度较快。由于其特有的开放性以及良好的扩展性，目前OSPF协议在各种网络中广泛部署。

  ![f400acc6762a863b0010cd9780e20ebe](https://user-images.githubusercontent.com/62100249/196881637-01f38b12-a43d-439c-b9ca-ba2017930aca.png)

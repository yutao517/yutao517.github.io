---
layout: article
title: 阿里云云原生容器工程师ACP认证(十)—容器服务ACK监控管理
tags: 阿里云云原生容器工程师 Kubernetes Docker
category: blog
date: 2022-07-22 14:37:00 +08:00
mermaid: true
---
## Kubernetes监控类型
从监控类型上划分，在Kubernetes中可以分成四个不同的类型：

- **资源监控**：CPU、内存、网络这种资源类的一个指标，通常这些指标会以数值、百分比的单位进行统计，是最常见的一个监控方式。这种监控方式在常规的监控里面都是可以做到的。

- **性能监控**：应用的内部监控，通常是通过Hook的机制在虚拟机层、字节码执行层通过隐式调用，或者是在应用层显示注入，获取更深层次的一个监控指标，一般是用来应用的调优和诊断的。

- **安全监控**：安全监控主要是对安全进行的一系列的监控策略，类似像越权管理、安全漏洞扫描等。

- **事件监控**：事件监控是 K8s 中比较另类的一种监控方式，紧密贴合Kubernetes的设计理念，补充常规监控方案的欠缺与弊端。

## 阿里云容器服务ACK监控管理
阿里云容器服务Kubernetes提供了云原生标准的监控接口
- 将监控的数据消费能力进行了标准化解耦
- 可以实现和不同云厂商提供的监控服务进行标准化接入
- 进行目前已经实现多个监控云服务打通接入。

![在这里插入图片描述](https://img-blog.csdnimg.cn/f3d0e0d61bde433bb06ebd476f202e95.png)

## 容器服务ACK可观测性组件-基础资源监控CloudMonitor

**云监控(CloudMonitor)**：是一项针对阿里云资源和互联网应用进行监控的服务。云监控用于监控各云服务资源的监控指标,探测云服务ECS和运营商站点的可用性,并针对指定监控指标设置报警，全面了解阿里云上资源的使用情况和业务运行状况，并及时对故障资源进行处理，保证业务正常运行。

**查看容器监控数据**：可以查看容器服务Kubernetes版集群监控数据，时刻掌握容器服务的运行情况。

**管理报警规则**：可以为容器服务Kubernetes版的集群设置报警规则,便于及时了解容器服务的异常并快速进行处理。

## 容器服务ACK可观测性组件-SLS日志服务
阿里云SLS 主要负责日志的采集、分析。在阿里云容器服务 Kubernetes 中， SLS 可以采集三种不同类型的日志：
-  APIServer 等核心组件的日志
- Service Mesh/Ingress 等接入层的日志
- 应用的标准日志

除了采集日志的标准链路外，SLS 还提供了上层的日志分析能力，默认提供了基于APIServer 的审计分析能力、接 入层的可观测性展现、应用层的日志分析。

## 容器服务ACK可观测性组件-应用实时监控服务 ARMS
应用实时监控服务 ARMS（ApplicationReal-Time Monitoring Service）：是一款阿里云应用性能管理（APM）类监控产品。可以基于前端、应用、业务自定义等维度，迅速便捷地为企业构建秒级响应的业务监控能力。

ARMS产品提供一系列监控定制功能，包括：数据接入、数据计算、数据存储、大盘展示和报管，以及下游API对接等环节。
用户只需要关心三件事：
- 数据从哪里来；
- 实时计算流程怎么编排；
- 数据该怎么用。

## 容器服务ACK可观测性组件-架构感知监控AHAS

AHAS是架构感知监控，通常在Kubernetes 集群中负载的类型大部分为微服务，微服务的调用拓扑也会比较复杂，因此当集群的网络链路出现问题时，如何快速定位问题、发现问题、诊断问题则成为了最大的难题。

AHAS通过网络的流量和走向，将集群的拓扑进行展现，提供更高层次的问题诊断方式。

- 为Kubernetes应用安装AHAS探针后，AHAS能自动识别系统中的Pod、Deployment、Service和它们与其他组件的依赖关系。
- 通过采集Kubernetes元信息，构建Kubernetes资源的物理拓扑关系，支持自建Kubernetes集群。阿里云容器服务Kubernetes集群。

## 阿里云容器服务ACK监控生态解决方案
从可观测性的角度，以ACK为基础的系统架构可以粗略分为4个层次，自下而上分别是：
- 基础设施层
- 容器性能层
- 应用性能层
- 用户业务层

![在这里插入图片描述](https://img-blog.csdnimg.cn/b66728afadec47de84c363e3b27da691.png)
[https://help.aliyun.com/document_detail/203344.html](https://help.aliyun.com/document_detail/203344.html)

## 阿里云容器服务ACK-基础资源监控
资源监控是Kubernetes中最常见的监控方式
- 通过资源监控可以快速查看负载的CPU、内存、网络等指标的使用率。
- 在阿里云容器服务中，资源监控已经与云监控互通，新建的集群默认安装与集成云监控。

1．登录容器服务管理控制台。

2．在集群列表页面中，单击目标集群名称或者目标集群右侧操作列下的详情。

3．在集群管理页左侧导航栏中，单击工作负载。

4．在页面上方选择命名空间，单击无状态页签。

5．选择所需的Deployment，单击右侧的监控，进入到云监控的相应的监控视图页面。

6．可以单击维度中的分组或实例，分别通过两个维度查看监控数据。

7．可选：如需设置告警，您可以在左侧导航栏单击报警规则并进行设置。分组级别的指标以group开头，实例级别的指标以pod开头。

